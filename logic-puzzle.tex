\section{Самая сложная логическая задача}

В качестве примера построения логической функции, удовлетворяющей заданным критериям, мы рассмотрим довольно безумную задачку, которая даже имеет собственное название, и называется она, ни много ни мало, «Самой сложной логической задачей» («The Hardest Logic Puzzle Ever»). Её автор~--- известный логик и философ Джорд Булос.

\begin{problem}
Довелось нам повстречаться с тремя богами. Они всезнающие и могут отвечать на вопросы, которые предполагают ответ «да» или «нет», причем один из богов всегда отвечает правду, один всегда врёт, а третьему вообще наплевать — он отвечает на вопросы как чёрт на душу положит. Дополнительная проблема в том, что хоть русским они и владеют, но говорить на нём ниже их достоинства. Вместо «да» и «нет» они говорят «ня» и «ми», причём что из этого что означает — неизвестно. Такой вот божественный язык. У нас есть возможность задать этим богам три вопроса, подразумевающих ответ «да» или «нет». Задавать вопросы можно в произвольном порядке, можно задавать разные или одинаковые вопросы. Каждый вопрос адресуется только одному богу. В результате после всех трёх вопросов вы должны точно указать, где бог вранья, где бог правды и где бог случая. Как это сделать?
\end{problem}

В принципе, изложенного в курсе до сих пор материала уже достаточно для того, чтобы решить эту головоломку. Вы можете подумать над ней некоторое количество времени и лишь потом читать дальше. Либо можете сразу читать.

При общении с богами нам необходимо получать понятные для нас ответы на вопросы. При общении со случайным богом мы ничего достоверно узнать не можем, поэтому в первую очередь мы будем выяснять, кто из них случайный. Это, однако, нам ещё только предстоит в дальнейшем — для начала нам надо понять, каким образом сформулировать вопрос так, чтобы ответ на него и бога правды, и бога лжи одновременно давал нам какие-то полезные сведения.

Чтобы было проще, решим для начала упрощённую версию этой задачи. Упрощения будут следующими:

\begin{enumerate}
\item Боги всё же отвечают по-русски, и мы можем точно интерпретировать их ответ.
\item Богов всего два — бог правды и бог лжи. Случайного бога нет.
\item Нам надо выяснить истинность некоторого высказывания, задав только один вопрос.
\end{enumerate}

Такая упрощённая задача как-то попалась сыну моего начальника на окружной олимпиаде по математике — только там речь шла не о богах, а о двух братьях, и у них надо было выяснить, какая дорога из двух правильная.

Обозначим через $a$ тот факт, что мы общаемся с богом правды, а через $\gamma$ высказывание, истинность которого нам необходимо установить. Мы хотим каким-то образом реализовать функцию $f$, представленную в таблице 1.7.

\begin{table}[h]
\centering
\begin{tabular}{cc|c}
$a$ & $\gamma$ & $f$ \\
\hline
 0  &     0    &  0  \\
 0  &     1    &  1  \\
 1  &     0    &  0  \\
 1  &     1    &  1
\end{tabular}
\caption{Требуемая функция в упрощённой задаче о богах}
\end{table}

То есть мы должны получить ответ «да» лишь в том случае, когда $\gamma$ истинно. Мы могли бы задать одному из двух богов следующий вопрос: «Верно ли, что $f$ истинно?». Однако нам известно, что если мы говорим с богом лжи ($a = 0$), то он на все вопросы будет давать противоположный ответ, поэтому нам \mbox{надо} задавать вопрос про истинность функции, которая в случае разговора с богом лжи принимает значение, противоположное $f$. Обозначим её через $q$. Её значения приведены в таблице 1.8.

\begin{table}[h]
\centering
\begin{tabular}{cc|cc}
$a$ & $\gamma$ & $f$ & $q$ \\
\hline
 0  &     0    &  0  &  1  \\
 0  &     1    &  1  &  0  \\
 1  &     0    &  0  &  0  \\
 1  &     1    &  1  &  1
\end{tabular}
\caption{Функция $q$, учитывающая, что один из богов врёт.}
\end{table}

Теперь, если мы будем задавать произвольному богу вопрос «верно ли $q$?», то оба бога будут отвечать «да» в том и только в том случае, когда верно интересующее нас $\gamma$. На человеческом языке этот вопрос можно сформулировать так: «Верно ли, что и $\gamma$, и то, что ты бог правды, либо одновременно верно, либо одновременно неверно?». Сложно и косноязычно, но, тем не менее, это вполне себе ответ на нашу задачу.

Теперь понятно, как действовать и в первоначальном случае. Теперь в качестве параметров функции ответа надо добавить ещё одно высказывание $b$, истинное в случае, когда «ня» означает русское «да». В случае, когда $b = 0$, нам надо ещё один раз подменить значения $0$ и $1$, чтобы ответ «ня» звучал в точности тогда, когда истинно $\gamma$:

\begin{table}[h]
\centering
\begin{tabular}{ccc|ccc}
$a$ & $b$ & $\gamma$ & $f$ & $q$ & $p$ \\
\hline
 0  &  0  &     0    &  0  &  1  &  0  \\
 0  &  0  &     1    &  1  &  0  &  1  \\
 0  &  1  &     0    &  0  &  1  &  1  \\
 0  &  1  &     1    &  1  &  0  &  0  \\
 1  &  0  &     0    &  0  &  0  &  1  \\
 1  &  0  &     1    &  1  &  1  &  0  \\
 1  &  1  &     0    &  0  &  0  &  0  \\
 1  &  1  &     1    &  1  &  1  &  1
\end{tabular}
\caption{Требуемая функция для первоначальной задачи.}
\end{table}

Теперь на вопрос «Правда ли, что верно $p$?», как бог правды, так и бог вранья будут отвечать «ня» в том и только в том случае, когда верно высказывание $\gamma$.

В устной форме, конечно, вопрос этот будет звучать слишком длинно и нелепо. Я приведу лишь начало вопроса: «Верно ли одновременно, что ты бог лжи, „ня“ означает „нет“ и $\gamma$ неверно, либо что одновременно ты бог лжи, „ня“ означает „да“ и $\gamma$ неверно, либо что одновременно...» — ну и так далее, продолжаем словами надиктовывать ДНФ. Выглядит такой вопрос убого, но это тем не менее решение, и, согласитесь, если бы это был вопрос жизни и смерти, то вас даже такое решение устроило бы.

Приведённое выше высказывание можно упростить. Например, по таблице истинности можно заметить, что $p = (a \leftrightarrow b) \leftrightarrow \gamma$. Можно было бы задать наш вопрос, исходя из этого представления, и он был бы короче, но пришлось бы как-то явно оговаривать, в каком смысле мы имеем в виду эквивалентность (смотрите замечание в первом параграфе об ассоциативности импликации и о том, что $(a\leftrightarrow b)\leftrightarrow c$ и $a \leftrightarrow b \leftrightarrow c$ традиционно интерпретируются по-разному).

Есть и более остроумный способ сформулировать вопрос. Опять же, проще понять этот способ, если сначала рассмотреть ситуацию, когда боги отвечают на русском языке. Вопрос тогда будет звучать так: «Что бы ты мне ответил, если бы я спросил тебя о верности $\gamma$?». С богом правды всё понятно — он бы ответил правду. Бог обмана же попадает с этим вопросом в ловушку — на наш вопрос он соврал бы, но именно в такой постановке вопроса он вынужден соврать ещё раз, и по правилу двойного отрицания он вынужден дать правдивый ответ.

Аналогичную идею можно использовать и когда боги отвечают «ня» или «ми». В этом случае вы можете задать такой вопрос: «Если бы я тебя спросил об истинности $\gamma$, ответил бы ты „ня“?» По таблице истинности вы можете убедиться в том, что ответ «ня» всегда однозначно будет указывать на истинность $\gamma$.

Из возможности поставить вопрос по-разному и трюка с двойным отрицанием можно вынести нравственный урок: не всегда хорошо известный способ, логично следующий из теории, приводит к лучшему ответу. Часто (чаще всего) то, что пишут в книгах или рассказывают на уроках, приводит к уродливым решениям, а чтобы найти какой-то более оптимальный подход, приходится проявлять фантазию.

Теперь, когда мы умеем вытаскивать информацию из бога правды и бога лжи, не зная, кто из них кто, и не зная их языка, мы можем приступать к окончательному решению задачи.

Когда мы задаём первый вопрос, всегда существует шанс, что мы задаём его богу случайности, и по его ответу мы не можем судить об истинности утверждения, которое нас интересует. Поэ\-то\-му в первую очередь нам надо узнать, какой бог не является случайным, и мы можем это сделать, задав богу вопрос о случайности какого-либо другого бога.

Вопрос может звучать так: «Правда ли, что бог, на которого я сейчас показываю пальцем, случаен?» И показываем при этом пальцем на какого-то другого бога, не на того, к которому мы обращаемся. Вопрос, понятно, мы задаём не напрямую, а изворотисто, в форме, найденной выше. Я просто уже не отвелекаюсь на мелочи, так как сейчас они и так понятны.

Если на наш вопрос о случайности бога мы получим ответ «да», мы можем однозначно сказать, что второй оставшийся бог~--- либо бог правды, либо бог лжи, но никак не бог случая. Дальше мы можем задавать вопросы гарантированно неслучайному богу, на этот раз рассчитывая на верный ответ в любом случае. Важно, что это работает даже в случае, когда мы изначально обращаемся к случайному богу — поскольку выбор мы делаем среди оставшихся двух богов, как бы бог случая ни ответил, мы всегда в точности можем определить одного неслучайного бога.

Когда один из неслучайных богов установлен, мы уже ему можем задать вопрос о случайности бога, которому мы задавали первый вопрос. Из ответа на этот вопрос мы будем точно знать, какой бог случайный, а какие два нет.

Последний, третий вопрос мы будем задавать не случайному богу о честности одного из богов. Ответ на этот вопрос окончательно расставит точки над тем, какой бог правдив, какой лжив, а какой случаен.

А это ровно то, что требовалось по условию задачи.
