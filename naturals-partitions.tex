\section{Разбиения множеств}

\begin{definition}
Число разбиений множества $[n]$ на множества мощностей $k_1, k_2, \ldots k_m$ называется \term{мультиномиальным коэффициентом} и обозначается как
$$n \choose k_1; k_2;\ldots; k_m$$
\end{definition}

В этом определении, очевидно, $k_1\ldots+ k_m = n$.

\begin{exercise}
Сколько можно получить различных слов путём перестановки букв в слове <<математика>>? Если теперь взять произвольно слово, то сколько слов можно получить различными перестановками?
\end{exercise}

\begin{thm}
$${n \choose k_1; k_2;\ldots; k_m} = \frac{n!}{k_1!k_2!\ldots k_m!}$$
\end{thm}
\begin{proof}
Выберём вначале $k_1$ элемент, споcобов сделать это $n\choose k_1$. Из оставшихся элементов теперь выберём во второе множество $k_2$ элементов, способов сделать это $n-k_1\choose k_2$. Продолжая рассуждать таким же образом, получаем
\begin{align*}
{n \choose k_1; k_2;\ldots; k_m} & = {n\choose k_1}{n-k_1\choose k_2}{n-k_1-k_2\choose k_3}\ldots{n-k_1-\ldots k_{m-1}\choose k_m} \\
&= \frac{n!}{k_1!(n-k_1)!}\cdot\frac{(n-k_1)!}{k_2!(n-k_1-k_2)!}\cdot\frac{(n-k_1-k_2)!}{k_3!(n-k_1-k_2-k_3)!}\cdot\ldots\\
&=\frac{n!}{k_1!k_2!\ldots k_m!}
\end{align*}
\end{proof}

\begin{thm}
$$(x_1+x_2\ldots x_m)^n = \sum_{k_1+\ldots + k_m = n}{n\choose k_1;k_2;\ldots;k_m}x_1^{k_1}x_2^{k_2}\ldots x_m^{k_m}$$
Здесь суммирование ведётся по всем возможным наборам чисел $\{k_i\}$, дающим в сумме $n$.
\end{thm}
\begin{proof}
Аналогично доказательству теоремы 3.26. Проведите его самостоятельно.
\end{proof}

\begin{exercise}
Покажите, что теорема 3.26 является частным случаем для теоремы 3.29.
\end{exercise}

\begin{exercise}
Покажите, что в теореме 3.29 будет ровно $n + k - 1 \choose n$ слагаемых.
\end{exercise}

\begin{definition}
\term{Числами Стирлинга второго рода} $\sstirling{n}{k}$ называется количество способов разбить множество $[n]$ на $k$ подмножеств.
\end{definition}

\begin{exercise}
Выразите $\sstirling{n}{k}$ через мультиномиальные коэффициенты.
\end{exercise}

\begin{definition}
\term{Числами Белла} $B(n)$ называется количество способов разбить множество $[n]$ на подмножества.
\end{definition}

\begin{thm}
$$B(n) = \sum_{k=1}^n\sstirling{n}{k}$$
\end{thm}
\begin{proof}
Очевидно.
\end{proof}

\begin{exercise}
Докажите, что $\sstirling{n}{2} = 2^{n-1} - 1$.
\end{exercise}

Значения $\sstirling{n}{1} = \sstirling{n}{n} = 1$ настолько очевидны, что даже не заслуживают отдельного упражнения. Остальные значения, как и в случае чисел Стирлинга первого рода и количества сочетаний, могут быть вичислены рекурсивно.

\begin{thm}
$$\sstirling{n}{k} = \sstirling{n-1}{k-1} + k\sstirling{n-1}{k}$$
\end{thm}
\begin{proof}
Рассмотрим элемент $n$ множества $[n]$. При разбиении $[n]$ на подмножества $n$ может войти в отдельное подмножество мощности 1, либо же войти в состав более крупного подмножества. В первом случае количество таких разбиений будет $\sstirling{n-1}{k-1}$~--- количество разбиений без учёта элемента $n$. Во втором случае мы опять же строим разбиение множества $[n-1]$, но уже на $k$ подмножеств. Нам остаётся лишь выбрать в какое из этих $k$ пожмножеств добавить элемент $n$. Получаем $k\sstirling{n-1}{k}$.
\end{proof}

Числа Белла так же допускают рекурсивное определние, хотя и не особо удобное.

\begin{thm}
$$B(n+1) = \sum_{k=0}^n{n \choose k} B(k)$$
\end{thm}
\begin{proof}
Пусть элемент $n+1$ при некотором разбиении множества $[n+1]$ попал в множество размера $k$. Есть $n\choose k - 1$ способов выбрать это множество, оставшиеся элементы можно разбить на подмножества $B(n+1-k)$ способами. Поскольку $k$ может быть произвольным от 1 до $n+1$, получаем
\begin{align*}
B(n+1) & = \sum_{k=1}^{n+1}{n\choose k-1}B(n+1-k)\\
& = \sum_{k=1}^{n+1}{n\choose n-k+1}B(n-k+1) \\
& = \sum_{k=0}^{n}{n\choose k}B(k)
\end{align*}
\end{proof}

Чтобы эта формула работала, нужно положить $B(0) = 1$ (чтобы увидеть это, примените 3.32 к значению $B(1)$), что соответствует интуиции: существует лишь одно разбиение пустого множества на подмножества, которое само является пустым множеством.

\begin{exercise}
Докажите, что для $n>2$ выполняется оценка
$$n! < \sstirling{2n}{n} < (2n)!$$
Вероятно вначале будет целесообразно, пользуясь 3.31, доказать, что $B(n) < n!$ при $n>3$.
\end{exercise}